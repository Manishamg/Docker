pipeline{
    agent any
    stages{
        stage ("httpd image pull"){
            steps{
            sh 'docker run -d --name imageapache httpd'
            }
        }
        stage ('docker images'){
            steps{
                sh 'docker images'
            }
        }
        stage("Run Commands in Container") {
            steps {
                script {
                    sh 'docker exec imageapache apt-get update'
                    sh 'docker exec imageapache curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"'
                    sh 'docker exec imageapache unzip awscliv2.zip'
                    sh 'docker exec imageapache sudo ./aws/install'
                    sh 'docker exec imageapache aws-cli --version'
                }
            }
        }
        /*stage ("entering into container"){
            steps{
                sh "docker exec imageapache /bin/bash"
                sh 'apt-get update'
                script{
                    sh 'curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip" '
                    sh 'unzip awscliv2.zip '
                    sh 'sudo ./aws/install '
                    sh 'aws-cli --version'
                }
            }
        }*/
    }
post{
    always{
     sh 'docker rm -f imageapache'
}}
}
